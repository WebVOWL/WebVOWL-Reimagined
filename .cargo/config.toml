# This config uses unstable features to improve compile times.
#
# "-fuse-ld=lld"
# One of the slowest aspects of compiling large Rust programs is the linking time. This file configures LLD as
# an alternate linker that may improve build times. LLD is a linker from the LLVM project that supports
# Linux, Windows, macOS, and Wasm.
#
# "-Zshare-generics=y"
# Make the current crate share its generic instantiations
# Note that you may have some issues with this flag on Windows. If compiling fails due to the 65k symbol limit,
# you may have to disable this setting. For more information and possible solutions to this error, see
# <https://github.com/bevyengine/bevy/issues/1110>.
#
# "-Zthreads=0"
# Enables rustc's parallel frontend, which improves performance when parsing, type checking, borrow
# checking, and more. We currently set `threads=0`, which defaults to the amount of cores in your CPU.

[build]
    rustflags=["-Zshare-generics=y", "-Zthreads=0"]
    target="wasm32-unknown-unknown"

[target.x86_64-unknown-linux-gnu]
    linker="clang"
    rustflags=["-Clink-arg=-fuse-ld=lld"]

[target.wasm32-unknown-unknown]
    rustflags=[
        "-Clink-arg=--max-memory=4294967296",
        "-Ctarget-feature=+atomics",          #+bulk-memory,+mutable-globals",
    ]

[unstable]
    # We need to build the standard library from source to support the "wasm32-unknown-unknown" target.
    build-std = ["std", "panic_abort", "core", "alloc"]
    build-std-features = ["panic_immediate_abort"]
